{% extends "base.twig" %}

{% block styles %}
<link rel="stylesheet" href="../public/Styles/Register.css">
{% endblock %}

{% block content %}
<div class="redd">
  <div class="head2">
    <button class="back" onclick="history.back()">&#8592;</button>
    <h3>Register</h3>
  </div>

  <div id="toast" class="toast"></div>

  <form id="register-form" class="register-page">
    <input type="email" name="email" placeholder="Email" required>
    <input type="password" name="password" placeholder="Password" required>
    <input type="text" name="fullName" placeholder="Full Name" required>
    <input type="text" name="phone" placeholder="Phone Number" required>
    <input type="text" name="address" placeholder="Address" required>
    <button type="submit">Register</button>
    <p>Already have an account? <a href="/login">Login</a></p>
  </form>
</div>

<footer class="footer">
  <div class="footer-content">
    <div class="footer-logo"><h2>TechWave</h2></div>
    <div class="footer-links">
      <a href="/">Home</a>
      <a href="/register">Register</a>
      <a href="/login">Login</a>
    </div>
    <div class="footer-socials">
      <a href="https://twitter.com" target="_blank"><i class="fa-brands fa-x-twitter"></i></a>
      <a href="https://linkedin.com" target="_blank"><i class="fa-brands fa-linkedin"></i></a>
      <a href="https://instagram.com" target="_blank"><i class="fa-brands fa-instagram"></i></a>
    </div>
  </div>
  <p class="footer-copy">Â© 2025 TechWave. All rights reserved.</p>
</footer>

<script>
const form = document.getElementById('register-form');
const toast = document.getElementById('toast');

function showToast(message, type='success') {
  toast.textContent = message;
  toast.className = 'toast ' + type;
  toast.style.display = 'block';
  setTimeout(() => { toast.style.display = 'none'; }, 3000);
}

form.addEventListener('submit', async (e) => {
  e.preventDefault();

  const data = {
    email: form.email.value.trim(),
    password: form.password.value.trim(),
    fullName: form.fullName.value.trim(),
    phone: form.phone.value.trim(),
    address: form.address.value.trim()
  };

  try {
    const res = await fetch('https://mockdata-93rw.onrender.com/users', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    if (res.ok) {
      showToast('Registration successful!', 'success');
      setTimeout(() => window.location.href = '/login', 1500);
    } else {
      showToast('Error submitting form.', 'error');
    }
  } catch (err) {
    showToast('Server error. Try again.', 'error');
  }
});
</script>
{% endblock %}
